<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="Content-Style-Type" content="text/css"/>
		<title>render triangle</title>
	</head>
	<body style='background-color: #000000'>
		<canvas id='canvasId' style = 'background-color: #000000; width: 512px; height: 256px;' >
			This text is displayed if your browser does not support HTML5 Canvas.
		</canvas>

		<script type='text/JavaScript' SRC="../../js/fubar_core_render.js" ></script>

		<!--hook events-->
		<script type='text/javascript'>
			<!-- 

var framework = undefined;
c.OnPageLoad = function() {
	console.info("OnPageLoad");
	var renderer = undefined;
	var task = function(in_timeDelta){
		if (undefined === renderer) {
			var canvas = document.getElementById('canvasId');	

			paramObject = {
				"extentions" : [
					//"OES_texture_float", 
					//"OES_texture_float_linear",
					//"OES_texture_half_float",
					//"OES_texture_half_float_linear",
					]
				};
			renderer = c.Render.Factory(canvas, paramObject);
		}
			
		var shader = renderer.NewShader(
			"attribute vec2 a_position;\
			void main() {\
				gl_Position = vec4(a_position, 0.0, 1.0);\
			}",
			"precision mediump float;\
			uniform vec4 u_colour;\
			void main() {\
				gl_FragColor = u_colour;\
			}",
			{ "a_position": null }, 
			{ "u_colour" : null }
		);

		var material = c.Material.Factory(
			shader,
			{ "u_colour" : c.ShaderUniform.Factory(
				c.ShaderUniform.s_type.Float4,
				c.DagNodeValue.Factory("u_colour", c.ColourRGBA.s_blue)
				)
			}
		);

		var model = renderer.NewModel(
			c.WebGL.TRIANGLES,
			3, 
			{
				"a_position" : c.ModelDataStream.Factory(
					c.WebGL.BYTE,
					2,
					new Int8Array([
						0, 0,
						0, 1,
						1, 0,
						]),
					c.WebGL.STATIC_DRAW,
					false
					)
			}
		);

		//draw
		renderer.Clear(c.ColourRGBA.s_red);
		renderer.RenderModel(material, model);

		return false;
	};
	framework = c.Framework.Factory(task);
}

c.OnShutdown = function() {
	console.info("OnShutdown");
}

window.addEventListener('load', c.OnPageLoad, true);

			// -->
		</script>
	</body>
</html>
